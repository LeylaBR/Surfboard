"use strict";var myMap,init=function(){myMap=new ymaps.Map("map",{center:[59.95,30.36],zoom:10,controls:[]});var t=new ymaps.GeoObjectCollection({},{iconLayout:"default#image",draggable:!1,iconImageHref:"./img/marker.svg",iconImageSize:[48,63],iconImageOffset:[-35,-52]});[[59.93563,30.327123],[59.897503,30.285242],[59.906931,30.515046],[60.051255,30.438184]].forEach(function(e){t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")};ymaps.ready(init);var mesureWidth=function(e){var t=0,n=$(window).width(),a=e.closest(".menu-slider__list").find(".menu-slider__subtitle"),r=a.width()*a.length,a=e.find(".menu-slider__desc-container"),e=parseInt(a.css("padding-left")),a=parseInt(a.css("padding-right"));return{container:t=window.matchMedia("(max-width: 768px)").matches?n-r:524,textContainer:t-e-a}},closeEveryItem=function(e){var t=e.find(".menu-slider__item"),e=e.find(".menu-slider__desc");t.removeClass("active"),e.width(0)},openItem=function(e){var t=e.find(".menu-slider__desc"),n=mesureWidth(e),a=e.find(".menu-slider__desc-container");e.addClass("active"),t.width(n.container),a.width(n.textContainer)};$(".menu-slider__subtitle").on("click",function(e){e.preventDefault();var t=$(e.currentTarget),n=t.closest(".menu-slider__item"),e=n.hasClass("active"),t=t.closest(".menu-slider__list");e?closeEveryItem(t):(closeEveryItem(t),openItem(n))}),$(".menu-slider-close-icon").on("click",function(e){closeEveryItem($(".menu-slider__list"))});var player,playerContainer=$(".player"),playerStart=$(".player__start"),playerDuration=$(".player__duration-estimate"),playerCompleted=$(".player__duration-completed"),playerButton=$(".player__playback-button"),playerPlaybackYellow=$(".player__playback-yellow"),playerPlayback=$(".player__playback"),playerSplash=$(".player__splash");playerStart.click(function(e){playerContainer.hasClass("paused")?player.pauseVideo():player.playVideo()}),playerPlayback.click(function(e){var t=$(e.currentTarget),e=e.originalEvent.layerX/t.width()*100,t=player.getDuration()/100*e;playerButton.css({left:"".concat(e,"%")}),playerPlaybackYellow.css({width:"".concat(e,"%")}),player.seekTo(t)}),playerSplash.click(function(e){player.playVideo(e)});var onPlayerReady=function(){var e,n=player.getDuration();playerDuration.text(n),void 0!==e&&clearInterval(e),setInterval(function(){var e=player.getCurrentTime(),t=e/n*100;playerButton.css({left:"".concat(t,"%")}),playerPlaybackYellow.css({width:"".concat(t,"%")}),playerCompleted.text(e)},1e3)},onPlayerStateChange=function(e){switch(e.data){case 1:playerContainer.addClass("active"),playerContainer.addClass("paused");break;case 2:playerContainer.removeClass("active"),playerContainer.removeClass("paused")}},isMobile=window.matchMedia("(max-width: 768px)").matches;function onYouTubeIframeAPIReady(){player=new YT.Player("yt-player",{height:"392",width:"622",videoId:"J5KIF3sVQZM",events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange},playerVars:{controls:0,disablekb:0,showinfo:0,rel:0,autoplay:0,modestbranding:0}})}var playerVolume=$(".player__volume"),playerRegulate=$(".player__volume-regulate"),playerVolumeButton=$(".player__volume__button"),playerRegulateYellow=$(".player__volume__regulate-yellow"),setVolumeStyle=function(e,t){playerRegulateYellow.css({width:"".concat(e,"%")}),playerVolumeButton.css({left:"".concat(t,"%")})};playerVolume.click(function(){playerVolume.hasClass("mute")?(playerVolume.removeClass("mute"),player.unMute(),setVolumeStyle(100,85)):(playerVolume.addClass("mute"),player.mute(),setVolumeStyle(0,0))}),setVolumeStyle(100,85),playerRegulate.click(function(e){var t=$(e.currentTarget),e=e.originalEvent.layerX/t.width()*100,t=player.getDuration()/100*e;setVolumeStyle(e,e),player.setVolume(t)});var openHamburger=document.querySelector("#menuHamburger"),menu=document.querySelector("#menu"),menuClose=document.querySelector("#menu-close"),menuAppearing=document.querySelectorAll(".hamburger__menu-link"),body=document.querySelector("body"),setStyles=function(e,t){menu.style.display=e,body.style.overflow=t};openHamburger.addEventListener("click",function(e){setStyles("block","hidden")}),menuClose.addEventListener("click",function(e){setStyles("none","initial")}),menuAppearing.forEach(function(e){e.addEventListener("click",function(e){setStyles("none","initial")})});var openDescription=$(".team__desc-info");openDescription.each(function(e,t){$(t).on("click",function(n){openDescription.each(function(e,t){n.currentTarget!==t&&$(t).parent().removeClass("active")}),$(n.currentTarget).parent().toggleClass("active")})});var openReviews=$(".reviews__switcher-item"),openItems=$(".reviews__item");openReviews.each(function(e,t){$(t).on("click",function(n){n.preventDefault(),openReviews.each(function(e,t){$(t).hasClass("active")&&($(t).removeClass("active"),$(openItems[e]).removeClass("active")),t===n.currentTarget&&($(t).addClass("active"),$(openItems[e]).addClass("active"))})})});var pointerLeft=$(".shop__pointer-left"),pointerRight=$(".shop__pointer-right"),slider=$(".shop__content-list").bxSlider({pager:!1,controls:!1});pointerLeft.click(function(e){e.preventDefault(),slider.goToPrevSlide()}),pointerRight.click(function(e){e.preventDefault(),slider.goToNextSlide()});var section=$("section"),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),inScroll=!1;section.first().addClass("active");var countSectionPosition=function(e){return-100*e},changeMenuThemeForSection=function(e){"black"===section.eq(e).attr("data-sidemenu-theme")?sideMenu.addClass("black"):sideMenu.removeClass("black")},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass("active")},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(section,e,"active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"active")},800))},viewportScroller=function(){var e=section.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}};$(window).on("wheel",function(e){var t=e.originalEvent.deltaY,e=viewportScroller();0<t&&e.next(),t<0&&e.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"===t||"textarea"===t,n=viewportScroller();if(!t)switch(e.keyCode){case 38:n.prev();break;case 40:n.next()}}),$(".wraper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),$("body").swipe({swipe:function(e,t){"up"===t&&"down"===t&&viewportScroller()["down"===t?"prev":"up"===t?"next":""]()},preventDefaultEvents:!1});var validateFields=function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""===e.val().trim()&&e.addClass("input-error")}),0===e.find(".input-error").length};$(".form").submit(function(e){e.preventDefault();var t=$(e.currentTarget),n=t.find("[name='name']"),a=t.find("[name='phone']"),r=t.find("[name='comment']"),e=t.find("[name='to']"),o=$("#modal").find(".modal__content");o.removeClass("error-modal"),validateFields(t,[n,a,r,e])&&$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:n.val(),phone:a.val(),comment:r.val(),to:e.val()},success:function(e){o.text(e.message),$.fancybox.open({src:"#modal",type:"inline"}),$(t)[0].reset()},error:function(e){e=e.responseJSON.message;o.text(e),o.addClass("error-modal"),$.fancybox.open({src:"#modal",type:"inline"})}})}),$(".app-submit-button").click(function(e){e.preventDefault(),$.fancybox.close()});